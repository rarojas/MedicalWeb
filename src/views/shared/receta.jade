// my-template.jade
extends ../layoutLogged

block head
  title Receta Médica

block scripts
  script(src='/js/receta.controller.js')
     
block content
  #inicio(ng-controller="recetaController as recetaCtrl")
    .container
      .row
        .col-md-12.col-sm-12
          .div-trans.text-center
            h3 Receta Médica
            form(name="form",class="css-form",novalidate,ng-submit="recetaCtrl.submitForm()")
              .col-md-12.col-sm-12
                .form-group
                  input.form-control(type='text',readonly="readonly",placeholder='Paciente')
              .form-group
                    button.btn.btn-success(type='button',ng-click="recetaCtrl.addMedicamento()") Agregar medicamento
              .row
                .col-md-4(ng-repeat="(key, medicamento) in recetaCtrl.receta.medicamentos")
                  .col-md-12.col-sm-12
                      label  Medicamento {{key + 1 }}
                      button.btn.btn-danger.pull-right(type='button',ng-click="recetaCtrl.removeMedicamento(medicamento)") x
                  .col-md-12.col-sm-12
                    +formvalid("mMedicamento_")
                      input.form-control(type='text',ng-model="medicamento.medicamento",name="mMedicamento_{{key}}",required='required',placeholder='Medicamento')
                      +message("mMedicamento_")
                  .col-md-12.col-sm-12
                    +formvalid("mDosis_")
                      input.form-control(type='text',ng-model="medicamento.dosis",name="mDosis_{{key}}",required='required',placeholder='Dosis')
                      +message("mDosis_")
                  .col-md-12.col-sm-12
                    +formvalid("mToma_")
                      input.form-control(type='text',ng-model="medicamento.toma",name="mToma_{{key}}",required='required',placeholder='Toma')
                      +message("mToma_")
                  .col-md-12.col-sm-12
                    +formvalid("mAdministracion_")
                      select.form-control(required='required',ng-model="medicamento.administracion",name="mAdministracion",ng-options="tipo.text for tipo in recetaCtrl.tipoAdministracionMedicamentoEnum track by tipo.value")
                        option(value="") Tipo Administracion
                  .col-md-12.col-sm-12
                    +formvalid("mInicio_")
                      label(for="mInicio_{{key}}") Fecha Inicio 
                      input.form-control(type='date',ng-model="medicamento.inicio",name="mInicio_{{key}}",required='required',placeholder='Desde',ng-min="{{recetaCtrl.minDate | date:'yyyy-MM-dd' }}")
                      +message("mInicio_")
                  .col-md-12.col-sm-12
                    +formvalid("mFin_")
                      label(for="mFin_{{key}}") Fecha Fin
                      input.form-control(type='date',ng-model="medicamento.fin",name="mFin_{{key}}",required='required',placeholder='Hasta', ng-min="medicamento.fin")
                      +message("mFin_")
              .col-md-12.col-sm-12
                .form-group(ng-class="{ 'has-error': form.mComment.$touched && form.mComment.$invalid }")
                    label(for="comment") Información Adicional
                    textarea(class="form-control",required='required',name="mComment",ng-model="receta.comentario",rows="5")
                    .help-block(ng-messages="form.mComment.$error",ng-show="form.mComment.$touched")
                      .div(ng-messages-include="/templates/shared/messages.html")
              .form-group
                button.btn.btn-success(type='submit',ng-disabled="form.$invalid") Crear Receta Médica
